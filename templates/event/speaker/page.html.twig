{% extends 'event/base.html.twig' %}

{% block header %}
    {% set menu = {'main': {'route' : 'event', 'title': 'Ma page speaker : %title%'|trans({'%title%': event.title}) }, 'items': []} %}
    {{ parent() }}
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/glyphicons.css') }}" media="screen" />
{% endblock %}

{% form_theme speakers_diner_form 'bootstrap_3_layout.html.twig' %}
{% form_theme hotel_reservation_form 'bootstrap_3_layout.html.twig' %}

{% block content %}

    <style>
        .speakers-infos-form {
            background: none;
            border: none;
            margin: 0;
            padding: 0;
            width: 100%;
        }

        .speakers-infos-form label {
            font-size: 1.1em;
            margin: 20px 0;
        }

        .speakers-infos-form .radio label,
        .speakers-infos-form .checkbox label {
            border: none;
            font-weight: normal;
            margin: 0;
        }

        .speakers-infos-form .list-unstyled,
        .speakers-infos-form .error {
            color: red;
        }
        .speakers-infos-form .submit-container {
            padding: 0 15px 0 0;
        }

        .speakers-infos-form--phone label {
            border: 0;
            margin: 0;
            min-width: auto;
            padding-right: 15px;
        }

        .speakers-infos-form--phone input[type="text"] {
            min-height: 3em;
        }

        .speakers-infos-form--diner textarea {
            width: 100%;
        }

        .speakers-infos-form--diner .submit-container {
            text-align: center;
        }
    </style>

    {% if talks_infos|length %}
    <div class="container">
        <div class="col-md-6">
            <h2>
                {% if talks_infos|length > 1 %}
                    {% trans %}Vos conf√©rences{% endtrans %}
                {% else %}
                    {% trans %}Votre conf√©rence{% endtrans %}
                {% endif %}
            </h2>

            <ul>
            {% for talk_info in talks_infos %}
                <li>
                    {{ talk_info.talk.title }}
                    <i>
                        {% if talk_info.planning %}
                            {% if talk_info.room %}({{ talk_info.room.name }}){% endif %}
                            ({{ talk_info.planning.start|localizeddate('full', 'short', app.request.locale) }})
                        {% else %}
                            (salle et dates de passage √† venir)
                        {% endif %}
                    </i>
                </li>
            {% endfor %}
            </ul>

            {% if speaker.referentPerson %}
            <h2><a id="referent-person" href="#referent-person">üß≠ {% trans %}Personne r√©f√©rente{% endtrans %}</a></h2>

            <b>{{ speaker.referentPerson }}</b>, {% trans %}sera votre personne de contact privil√©gi√©e dans les semaines menant √† l‚Äô√©v√®nement tout comme durant l‚Äô√©v√®nement. N‚Äôh√©sitez pas √† prendre contact pour toutes questions relatives √† votre venue.{% endtrans %}
                {% if speaker.referentPersonEmail %}Son adresse email est <a href="mailto:{{ speaker.referentPersonEmail }}">{{ speaker.referentPersonEmail }}</a>.{% endif %}
            {% endif %}

            <h2><a id="contact" href="#contact">üìû {% trans %}Moyen de contact{% endtrans %}</a></h2>
            <p>{{ 'speakers_contact_help'|trans }}</p>

            {{ form_start(speakers_contact_form, { attr: { class: "speakers-infos-form speakers-infos-form--phone" }, action: '#contact'}) }}
            <div class="container">
                <span>
                    {{ form_label(speakers_contact_form.phone_number) }}
                </span>
                <span>
                    {{ form_widget(speakers_contact_form.phone_number) }}
                    {{ form_errors(speakers_contact_form.phone_number) }}
                </span>
                <span>
                    {{ form_widget(speakers_contact_form.submit, {attr: {title: "Enregistrer le contact"}}) }}
                </span>
            </div>

            {{ form_end(speakers_contact_form) }}

            {% if event.speakersDinerEnabled %}
            <h2><a id="diner" href="#diner">üçΩÔ∏è {% trans %}Nous vous invitons au restaurant{% endtrans %}</a></h2>

            <p>{{ "Le repas des conf√©renciers, r√©unissant l'√©quipe d'organisation, les b√©n√©voles, les sponsors et les speakers, se tiendra le soir du %date%." | trans({"%date%": day_before_event|date('d/m/Y')}) }}</p>

            {% if should_display_speakers_diner_form %}
                <p>{% trans %}Si vous avez un r√©gime alimentaire sp√©cifique, n'h√©sitez pas √† nous en faire part pour pr√©venir le chef.{% endtrans %}</p>

                {{ form_start(speakers_diner_form, { attr: { class: "speakers-infos-form speakers-infos-form--diner" }, action: '#diner'}) }}

                <div class="container">
                    <div class="col-md-6">
                        {{ form_label(speakers_diner_form.will_attend) }}
                        {{ form_errors(speakers_diner_form.will_attend) }}
                        {{ form_widget(speakers_diner_form.will_attend) }}
                    </div>

                    <div class="col-md-6">
                        {{ form_label(speakers_diner_form.has_special_diet) }}
                        {{ form_errors(speakers_diner_form.has_special_diet) }}
                        {{ form_widget(speakers_diner_form.has_special_diet) }}
                    </div>
                </div>

                <div class="container">
                    <div class="col-md-12">
                        {{ form_label(speakers_diner_form.special_diet_description) }}
                        {{ form_errors(speakers_diner_form.special_diet_description) }}
                        {{ form_widget(speakers_diner_form.special_diet_description) }}
                    </div>
                </div>

                <div class="submit-container">
                    {{ form_widget(speakers_diner_form.submit, {attr: {title: "Enregistrer mes pr√©f√©rences pour le restaurant"}}) }}
                </div>

                {{ form_end(speakers_diner_form) }}
            {% else %}
                {% if speaker.willAttendSpeakersDiner is null %}
                    <p>{% trans %}Vous ne nous avez pas indiqu√© d'informations √† propos de votre venue au repas des speakers.{% endtrans %}</p>
                {% else %}
                    {% if speaker.willAttendSpeakersDiner %}
                        <p>{% trans %}Vous nous avez indiqu√© √™tre pr√©sent au repas.{% endtrans %}</p>

                        {% if speaker.hasSpecialDiet and speaker.specialDietDescription%}
                            <p>{% trans %}Vous nous avez indiqu√© avoir un r√©gime alimentaire particulier, avec ces pr√©cisions :{% endtrans %}</p>

                            <pre>
                        {{ speaker.specialDietDescription }}
                    </pre>
                        {% else %}
                            <p>{% trans %}Vous nous avez indiqu√© ne pas avoir de r√©gime alimentaire particulier.{% endtrans %}</p>
                        {% endif %}
                    {% else %}
                        <p>Vous nous avez indiqu√© ne pas √™tre pr√©sent au repas.</p>
                    {% endif %}
                {% endif %}
            {% endif %}
            {% endif %}

            {% if event.accomodationEnabled %}
            <h2><a id="hotel" href="#hotel">üõéÔ∏è {% trans %}Nous vous h√©bergeons{% endtrans %}</a></h2>

            {% if should_display_hotel_reservation_form %}
                {{ form_start(hotel_reservation_form, { attr: { class: 'speakers-infos-form'}, action: '#hotel'}) }}

                <div class="container">
                    <div class="col-md-6">
                        {{ form_label(hotel_reservation_form.nights) }}
                        {{ form_errors(hotel_reservation_form.nights) }}
                        {{ form_widget(hotel_reservation_form.nights) }}
                    </div>
                    <div class="col-md-6">
                        <i>{% trans %}Vous disposez de deux nuits d'h√¥tel maximum. Donnez-nous les dates qui vous conviennent, nous nous chargeons de la r√©servation ! (les speakers intercontinentaux peuvent b√©n√©ficier de plus de nuit√©s, si vous √™tes dans ce cas, le p√¥le conf√©rence vous aura contact√©).{% endtrans %}</i>

                    </div>
                </div>

                <div class="submit-container">
                    {{ form_widget(hotel_reservation_form.submit, {attr: {title: "Enregistrer les nuit√©es"}}) }}
                </div>

                {{ form_end(hotel_reservation_form) }}
            {% else %}
                {% if speaker.hasNoHotelNight %}
                    {% trans %}Vous nous avez indiqu√© que n'avez pas besoin de nuit d'hotel.{% endtrans %}
                {% else %}
                    {% trans %}Des nuits d'h√¥tel vous seront r√©serv√©es ces nuits :{% endtrans %}
                    <ul>
                    {% if speaker.hasHotelNightBefore %}
                        <li>{% trans %}La nuit entre la veille de l'√©v√®nement et le premier jour.{% endtrans %}</li>
                    {% endif %}
                    {% if speaker.hasHotelNightBetween %}
                        <li>{% trans %}La nuit entre le premier jour et le second jour.{% endtrans %}</li>
                    {% endif %}
                    {% if speaker.hasHotelNightAfter %}
                        <li>{% trans %}La nuit entre le deuxi√®me jour de l'√©v√®nement et le lendemain de l'√©v√®nement.{% endtrans %}</li>
                    {% endif %}
                    </ul>
                {% endif %}
            {% endif %}
            {% endif %}

            <h2><a id="expenses" href="#expenses">üí∂ {% trans %}Nous vous d√©frayons{% endtrans %}</a></h2>

            <div class="container">
                <p>
                    {% trans %}venue_speaker.expenses.intro{% endtrans %}
                </p>
                <div class="row">
                    <div class="col-md-6">
                        <p>
                            <strong>{% trans %}Liste des fichiers envoy√©s{% endtrans %}</strong>
                        </p>
                        {% if speakers_expenses_files|length %}
                            <ul>
                                {% for file in speakers_expenses_files %}
                                    {% set queryParams = app.request.attributes.get('_route_params')|merge(app.request.query.all)|merge({'delete_file': file.basename}) %}
                                    {% set queryParams = app.request.attributes.get('_route_params')|merge(app.request.query.all)|merge({'delete_file': file.basename}) %}
                                    <li>
                                        <a href="{{ path('speaker-infos-files', {speakerId: speaker.id, eventSlug: event.path, filename: file.basename}) }}" target="_blank" title="T√©l√©charger le fichier {{ file.basename }}">
                                            {{ file.basename }}
                                        </a>
                                        <a href="{{ path(app.request.attributes.get('_route'), queryParams) }}#expenses"
                                           onclick="window.confirm('{% trans %}√ätes-vous s√ªr(e) de vouloir supprimer ce fichier ?{% endtrans %}')"
                                           title="{% trans with {'%filename%': file.basename} %}Supprimer le fichier %filename%{% endtrans %}">
                                            <i class="glyphicon glyphicon-remove"></i>
                                        </a>
                                    </li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            <p>{% trans %}Aucun fichier de d√©fraiement{% endtrans %}</p>
                        {% endif %}
                    </div>
                    <div class="col-md-6">

                        {{ form_start(speakers_expenses_form, { attr: { class: 'speakers-infos-form'}, action: '#expenses' }) }}
                        <div class="error">
                            {{ form_errors(speakers_expenses_form.files) }}
                        </div>
                        <div style="margin-bottom: 2rem;">
                            {{ form_widget(speakers_expenses_form.files) }}
                        </div>
                        <div class="submit-container">
                            {{ form_row(speakers_expenses_form.submit) }}
                        </div>
                        {{ form_end(speakers_expenses_form) }}

                    </div>
                </div>
            </div>

        </div>

        <div class="col-md-6">
            {{ description|markdown }}
        </div>
    </div>
    {% else %}
        <div class="container">
            <div class="col-md-12">
                Aucune conf√©rence programm√©e trouv√©e.
            </div>
        </div>
    {% endif %}
{% endblock %}

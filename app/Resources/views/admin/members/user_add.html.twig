{% extends 'admin/base_with_header.html.twig' %}

{% form_theme form 'form_theme_admin.html.twig' %}

{% block content %}
    <h2>Ajouter une personne physique</h2>
    <div class="ui segment">
        {{ form_start(form) }}
        <h2 class="ui header">Informations</h2>
        <div class="ui clearing divider"></div>
        <div>
            <div class="ui form">
                {{ form_row(form.companyId) }}
                {{ form_row(form.civility) }}
                {{ form_row(form.lastname, {attr: {'data-role': 'field-lastname'}}) }}
                {{ form_row(form.firstname, {attr: {'data-role': 'field-firstname'}}) }}
                {{ form_row(form.email) }}
                {{ form_row(form.alternateEmail) }}
                {{ form_row(form.address) }}
                {{ form_row(form.zipcode) }}
                {{ form_row(form.city) }}
                {{ form_row(form.countryId) }}
                {{ form_row(form.phone) }}
                {{ form_row(form.cellphone) }}
            </div>
        </div>
        <h2 class="ui header">Paramètres</h2>
        <div class="ui clearing divider"></div>
        <div>
            <div class="ui form">
                {{ form_row(form.level) }}
                {{ form_row(form.directoryLevel) }}
                {{ form_row(form.eventLevel) }}
                {{ form_row(form.websiteLevel) }}
                {{ form_row(form.officeLevel) }}
                {{ form_row(form.status) }}
                {{ form_row(form.login, {attr: {'data-role': 'field-login'}}) }}
                <div class="inline fields ui grid">
                    <div class="three wide column"></div>
                    <div class="field nine wide column">
                        Ne renseignez le mot de passe et sa confirmation que si vous souhaitez le définir
                    </div>
                </div>
                {{ form_row(form.password) }}
                {{ form_row(form.roles) }}
                {{ form_row(form.needsUpToDateMembership) }}

                <div class="inline fields ui grid">
                    <div class="three wide column"></div>
                    <div class="field nine wide column">
                        {{ form_row(form.save, {attr: {class: "ui primary button"}}) }}
                    </div>
                </div>
            </div>
            {{ form_end(form) }}
        </div>
    </div>
{% endblock %}

{% block javascript %}
    {{ parent() }}
    <script src="/javascript/fonctions.js" defer="defer"></script>
    <script>
        $(() => {
            const firstname = document.querySelector('[data-role="field-firstname"]');
            const lastname = document.querySelector('[data-role="field-lastname"]');
            const login = document.querySelector('[data-role="field-login"]');
            const updateLogin = () => login.value = creerLogin(lastname.value, firstname.value);
            firstname.addEventListener('blur', updateLogin);
            lastname.addEventListener('blur', updateLogin);
        });
    </script>
{% endblock %}
